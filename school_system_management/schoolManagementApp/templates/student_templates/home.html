<!--- PAGINA CU CONTENTUL PRINCIPAL CE SE VA INCARCA DINAMIC-->

{% extends 'student_templates/base.html' %} {% block page_title %} Student
Dashboard {% endblock page_title %} {% block main-content %}

<!--CARDURILE CU INFORMATIILE GENERALE-->
<section class="content">
  <div class="container-fluid">
    <div class="row">
      <div class="col-lg-3 col-6">
        <div class="small-box bg-info">
          <div class="inner">
            <h3>{{absent}}</h3>
            <p>Unmotivated Absences</p>
          </div>
          <div class="icon">
            <i class="ion ion-alert"></i>
          </div>
          <a href="{% url 'student_view_attendance' %}" class="small-box-footer"
            >More info <i class="fas fa-arrow-circle-right"></i
          ></a>
        </div>
      </div>

      <div class="col-lg-3 col-6">
        <div class="small-box bg-success">
          <div class="inner">
            <h3>{{present}}<sup style="font-size: 20px">%</sup></h3>
            <p>Attendance Report</p>
          </div>
          <div class="icon">
            <i class="ion ion-stats-bars"></i>
          </div>
          <a href="{% url 'student_view_attendance' %}" class="small-box-footer"
            >More info <i class="fas fa-arrow-circle-right"></i
          ></a>
        </div>
      </div>

      <div class="col-lg-3 col-6">
        <div class="small-box bg-warning">
          <div class="inner">
            <h3>{{leave_report}}</h3>
            <p>Approval Applications</p>
          </div>
          <div class="icon">
            <i class="ion ion-document-text"></i>
          </div>
          <a href="{% url 'student_applyfor_leave' %}" class="small-box-footer"
            >More info <i class="fas fa-arrow-circle-right"></i
          ></a>
        </div>
      </div>

      <div class="col-lg-3 col-6">
        <div class="small-box bg-danger">
          <div class="inner">
            <h3>{{subjects}} <span style="font-size: 15px">subjects</span></h3>
            <p>Being enrolled at</p>
          </div>
          <div class="icon">
            <i class="ion ion-easel"></i>
          </div>
          <a href="#" class="small-box-footer">&nbsp;</a>
        </div>
      </div>
    </div>
  </div>


<!--CHART-URL REFERITOR LA PREZENTA-->
<div class="row">
  <div class="col-lg-6">
    <div class="card card-danger" style="margin-left: 8px;">
      <div class="card-header">
        <h3 class="card-title">Attendance Chart</h3>
        <div class="card-tools">
          <button
            type="button"
            class="btn btn-tool"
            data-card-widget="collapse"
          >
            <i class="fas fa-minus"></i>
          </button>
          <button type="button" class="btn btn-tool" data-card-widget="remove">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div class="card-body">
        <div class="chartjs-size-monitor">
          <div class="chartjs-size-monitor-expand"><div class=""></div></div>
          <div class="chartjs-size-monitor-shrink"><div class=""></div></div>
        </div>
        <canvas
          id="pieChart"
          style="
            min-height: 250px;
            height: 250px;
            max-height: 250px;
            max-width: 100%;
            display: block;
            width: 765px;
          "
          width="765"
          height="250"
          class="chartjs-render-monitor"
        ></canvas>
      </div>
    </div>
  </div>

  <div class="col-lg-6">
    <div class="card card-success" style="margin-right: 8px;">
      <div class="card-header">
        <h3 class="card-title">Bar Chart</h3>
        <div class="card-tools">
          <button
            type="button"
            class="btn btn-tool"
            data-card-widget="collapse"
          >
            <i class="fas fa-minus"></i>
          </button>
          <button type="button" class="btn btn-tool" data-card-widget="remove">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div class="card-body">
        <div class="chart">
          <div class="chartjs-size-monitor">
            <div class="chartjs-size-monitor-expand"><div class=""></div></div>
            <div class="chartjs-size-monitor-shrink"><div class=""></div></div>
          </div>
          <canvas
            id="barChart"
            style="
              min-height: 250px;
              height: 250px;
              max-height: 250px;
              max-width: 100%;
              display: block;
              width: 765px;
            "
            width="765"
            height="250"
            class="chartjs-render-monitor"
          ></canvas>
        </div>
      </div>
    </div>
  </div>
</div>
</section>

{% endblock main-content %} {% block base_js %}
<script>
  $(document).ready(function () {
    var subjects = {{ subject_name|safe }};
    var present = {{ subject_present }};
    var absent = {{ subject_absent }};
    var pieData = {
      labels: ["Absent", "Present"],
      datasets: [
        {
          data: [{{absent}}, {{total_present}}],
          backgroundColor: [
            "#f56954",
            "#00a65a"
          ],
        },
      ],
    };

    var areaChartData = {
      labels  : subjects,
      datasets: [
        {
          label               : 'Present at Course',
          backgroundColor     : 'rgba(60,141,188,0.9)',
          borderColor         : 'rgba(60,141,188,0.8)',
          pointRadius          : false,
          pointColor          : '#3b8bba',
          pointStrokeColor    : 'rgba(60,141,188,1)',
          pointHighlightFill  : '#fff',
          pointHighlightStroke: 'rgba(60,141,188,1)',
          data                : present
        },
        {
          label               : 'Absent at Course',
          backgroundColor     : 'rgba(210, 214, 222, 1)',
          borderColor         : 'rgba(210, 214, 222, 1)',
          pointRadius          : false,
          pointColor          : '#3b8bba',
          pointStrokeColor    : 'rgba(210, 214, 222, 1)',
          pointHighlightFill  : '#fff',
          pointHighlightStroke: 'rgba(220,220,220,1',
          data                : absent
        }
      ]
    }
    var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
    var pieOptions = {
      maintainAspectRatio: false,
      responsive: true,
    };
    //Create pie or douhnut chart
    // You can switch between pie and douhnut using the method below.
    new Chart(pieChartCanvas, {
      type: "pie",
      data: pieData,
      options: pieOptions,
    });

    var barChartCanvas = $('#barChart').get(0).getContext('2d')
    var barChartData = $.extend(true, {}, areaChartData)
    var temp0 = areaChartData.datasets[0]
    barChartData.datasets[0] = temp0
    var barChartOptions = {
      responsive              : true,
      maintainAspectRatio     : false,
      datasetFill             : false
    }

    new Chart(barChartCanvas, {
      type: 'bar',
      data: barChartData,
      options: barChartOptions
    })

  });
</script>

{% endblock base_js %}
